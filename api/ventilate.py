"""
Vercel Serverless Function: –ü—Ä–æ–≤–µ—Ç—Ä–∏—Ç—å —á–∞—Ç
–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∞–±—Å—É—Ä–¥–Ω—ã—Ö –∫–æ—Ä–æ—Ç–∫–∏—Ö —Å–æ–±—ã—Ç–∏–π –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Ñ–æ—Ä—Ç–æ—á–∫–∏
–° –∞–∫—Ç—É–∞–ª—å–Ω—ã–º–∏ –Ω–æ–≤–æ—Å—Ç—è–º–∏, —á—ë—Ä–Ω—ã–º —é–º–æ—Ä–æ–º –∏ —Å–∞—Ç–∏—Ä–æ–π
"""
import json
import os
import random
from http.server import BaseHTTPRequestHandler
import urllib.request
import urllib.error
from datetime import datetime


AI_GATEWAY_URL = "https://ai-gateway.vercel.sh/v1/messages"

# –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å–æ–±—ã—Ç–∏–π –¥–ª—è —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è ‚Äî –†–ê–°–®–ò–†–ï–ù–ù–´–ï
EVENT_CATEGORIES = [
    "–ñ–ò–í–û–¢–ù–´–ï: –≥–æ–ª—É–±—å-–∫–∞–º–∏–∫–∞–¥–∑–µ, –≤–æ—Ä–æ–Ω–∞ —Å –≥—Ä–∞–Ω–∞—Ç–æ–π, —á–∞–π–∫–∞ –∏–∑ –ü–∏—Ç–µ—Ä–∞ (–∞–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è), –ª–µ—Ç—É—á–∞—è –º—ã—à—å —Å –∫–æ–≤–∏–¥–æ–º, —Ä–æ–π –ø—á—ë–ª-—É–±–∏–π—Ü, –∫—Ä—ã—Å–∞-–º—É—Ç–∞–Ω—Ç –∏–∑ –º–µ—Ç—Ä–æ, –∫–æ—Ç –®—Ä—ë–¥–∏–Ω–≥–µ—Ä–∞, –º–µ–¥–≤–µ–¥—å –Ω–∞ —Å–∞–º–æ–∫–∞—Ç–µ, –ª–æ—Å—å –≤ –¥–µ–ø—Ä–µ—Å—Å–∏–∏",
    "–ü–û–ì–û–î–ê: —É—Ä–∞–≥–∞–Ω '–ü—É—Ç–∏–Ω', —Å–∫–≤–æ–∑–Ω—è–∫ –∏–∑ –∞–¥–∞, –º–æ—Ä–æ–∑ –∫–∞–∫ –≤ –¥—É—à–µ, –∂–∞—Ä–∞ –∫–∞–∫ –≤ –∞–¥—É, –∫–∏—Å–ª–æ—Ç–Ω—ã–π –¥–æ–∂–¥—å, —Ä–∞–¥–∏–æ–∞–∫—Ç–∏–≤–Ω—ã–π —Å–Ω–µ–≥, –≥—Ä–∞–¥ —Ä–∞–∑–º–µ—Ä–æ–º —Å —è–π—Ü–∞ –§–∞–±–µ—Ä–∂–µ, –ø–µ—Å—á–∞–Ω–∞—è –±—É—Ä—è –∏–∑ –°–∞—Ö–∞—Ä—ã, —Å–º–æ–≥ –∏–∑ –ß–µ–ª—è–±–∏–Ω—Å–∫–∞",
    "–ü–†–ï–î–ú–ï–¢–´ –ó–ê–õ–ï–¢–ï–õ–ò: –ø–∞–∫–µ—Ç –∏–∑ –ü—è—Ç—ë—Ä–æ—á–∫–∏ —Å –ø—Ä–æ—Å—Ä–æ—á–∫–æ–π, –≥–∞–∑–µ—Ç–∞ '–ü—Ä–∞–≤–¥–∞' 1937 –≥–æ–¥–∞, –ø–æ–≤–µ—Å—Ç–∫–∞ –∏–∑ –≤–æ–µ–Ω–∫–æ–º–∞—Ç–∞, –±–∏—Ç–∫–æ–∏–Ω (—É–ø–∞–ª), NFT –æ–±–µ–∑—å—è–Ω—ã, –ª–µ—Ç–∞—é—â–∏–π —É–Ω–∏—Ç–∞–∑, –¥—Ä–æ–Ω —Å –ê–ª–∏—ç–∫—Å–ø—Ä–µ—Å—Å–∞, —á–µ–π-—Ç–æ –¥–∏–ø–ª–æ–º (—Ñ–∞–ª—å—à–∏–≤—ã–π), —Ä–µ–∑—é–º–µ –Ω–∞ —Ä–∞–±–æ—Ç—É –º–µ—á—Ç—ã (–æ—Ç–∫–ª–æ–Ω–µ–Ω–æ)",
    "–ü–†–ï–î–ú–ï–¢–´ –£–õ–ï–¢–ï–õ–ò: –Ω–∞–¥–µ–∂–¥–∞ –Ω–∞ –ø–µ–Ω—Å–∏—é, –≤–µ—Ä–∞ –≤ —á–µ–ª–æ–≤–µ—á–µ—Å—Ç–≤–æ, –¥–µ–Ω—å–≥–∏ (–≤—Å–µ), –ø–æ—Å–ª–µ–¥–Ω–∏–µ –º–æ–∑–≥–∏, –æ—Å—Ç–∞—Ç–∫–∏ —Å–æ–≤–µ—Å—Ç–∏, –ø–ª–∞–Ω –Ω–∞ –∂–∏–∑–Ω—å, –º–æ—Ç–∏–≤–∞—Ü–∏—è, —Å–∏–ª–∞ –≤–æ–ª–∏, –ª–∏–±–∏–¥–æ",
    "–°–û–°–ï–î–ò: –±–∞–±–∫–∞-—Ç–µ–ª–µ–ø–∞—Ç —Å–Ω–∏–∑—É, —Å–æ—Å–µ–¥-–±–∞—Ä–∞–±–∞–Ω—â–∏–∫, –∞–ª–∫–∞—à –ü–µ—Ç—Ä–æ–≤–∏—á —Å –±–∞–ª–∞–ª–∞–π–∫–æ–π, —Å–µ–º—å—è —Å 12 –¥–µ—Ç—å–º–∏, –±—ã–≤—à–∞—è/–±—ã–≤—à–∏–π —Å –Ω–æ–≤–æ–π –ø–∞—Å—Å–∏–µ–π, –∫–æ–ª–ª–µ–∫—Ç–æ—Ä, —É—á–∞—Å—Ç–∫–æ–≤—ã–π",
    "–ú–ò–°–¢–ò–ö–ê: –ø—Ä–∏–∑—Ä–∞–∫ –°–°–°–†, –¥—É—Ö –∫–∞–ø–∏—Ç–∞–ª–∏–∑–º–∞, —Ç–µ–Ω—å —Å–∞–Ω–∫—Ü–∏–π, —Ö–æ–ª–æ–¥ –∏–∑ –º–æ—Ä–≥–∞, –∑–∞–ø–∞—Ö —Å–µ—Ä—ã –∏–∑ –æ—Ñ–∏—Å–∞, –≥–æ–ª–æ—Å HR —Å —Ç–æ–≥–æ —Å–≤–µ—Ç–∞, –∫–∞—Ä–º–∞ –∑–∞ –ø—Ä–æ—à–ª—É—é –∂–∏–∑–Ω—å, –¥–µ–º–æ–Ω –ø—Ä–æ–∫—Ä–∞—Å—Ç–∏–Ω–∞—Ü–∏–∏",
    "–ó–ê–ü–ê–•–ò: —à–∞—É—Ä–º–∞ —Å —É—Ä–∞–Ω–æ–≤—ã–º —Å–æ—É—Å–æ–º, –≤—ã—Ö–ª–æ–ø –æ—Ç '–õ–∞–¥—ã', –ø–µ—Ä–µ–≥–∞—Ä –¥–µ–ø—É—Ç–∞—Ç–∞, –∑–∞–ø–∞—Ö –¥–µ–Ω–µ–≥ (—á—É–∂–∏—Ö), –∞—Ä–æ–º–∞—Ç —É—Å–ø–µ—Ö–∞ (–Ω–µ–¥–æ—Å—Ç–∏–∂–∏–º–æ–≥–æ), –≤–æ–Ω—å —Å—Ç–∞—Ä—Ç–∞–ø–∞, –¥—É—Ö –±—é—Ä–æ–∫—Ä–∞—Ç–∏–∏",
    "–ö–ê–¢–ê–°–¢–†–û–§–´: –æ–±–≤–∞–ª —Ä—É–±–ª—è, –∫—Ä–∞—Ö –∫—Ä–∏–ø—Ç—ã, –ø–æ—Ç–æ–ø –∏–∑ –æ—Ñ–∏—Å–∞ –≤—ã—à–µ, –ø–æ–∂–∞—Ä –≤ –¥–∞—Ç–∞—Ü–µ–Ω—Ç—Ä–µ, –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞, –∫–æ–Ω–µ—Ü —Å–≤–µ—Ç–∞ (–ª–æ–∫–∞–ª—å–Ω—ã–π), –∞–ø–æ–∫–∞–ª–∏–ø—Å–∏—Å –≤ –º–∏–Ω–∏–∞—Ç—é—Ä–µ",
    "–ü–û–õ–ò–¢–ò–ö–ê/–ê–ö–¢–£–ê–õ–ö–ê: —Å–∞–Ω–∫—Ü–∏–∏ –Ω–∞ –≤–µ—Ç–µ—Ä, –Ω–µ–π—Ä–æ—Å–µ—Ç—å-–º–∏–≥—Ä–∞–Ω—Ç, –∏–Ω—Ñ–ª—è—Ü–∏—è –≤ —á–µ–ª–æ–≤–µ—á–µ—Å–∫–æ–º –æ–±–ª–∏—á–∏–∏, –ø–µ–Ω—Å–∏–æ–Ω–Ω–∞—è —Ä–µ—Ñ–æ—Ä–º–∞ (–∫—É—Å–∞–µ—Ç—Å—è), –Ω–∞–ª–æ–≥–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ (–≤–Ω–µ–∑–∞–ø–Ω–∞—è), –∫—É—Ä—Å –¥–æ–ª–ª–∞—Ä–∞ (–∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π)",
    "–ò–ù–¢–ï–†–ù–ï–¢/–ú–ï–ú–´: –≤–∏—Ä—É—Å–Ω—ã–π —Ç–∏–∫—Ç–æ–∫, —Ç–æ–∫—Å–∏—á–Ω—ã–π –∫–æ–º–º–µ–Ω—Ç–∞—Ç–æ—Ä, —Ö–µ–π—Ç–µ—Ä –∏–∑ —Ç–≤–∏—Ç—Ç–µ—Ä–∞, —Ç—Ä–æ–ª–ª—å –∏–∑ –æ–¥–Ω–æ–∫–ª–∞—Å—Å–Ω–∏–∫–æ–≤, –±–æ—Ç –∏–∑ —Ç–µ–ª–µ–≥—Ä–∞–º–∞, —Å–ø–∞–º–µ—Ä —Å –∫—Ä–∏–ø—Ç–æ–π, –∏–Ω—Ñ–æ—Ü—ã–≥–∞–Ω"
]

# –ê–∫—Ç—É–∞–ª—å–Ω—ã–µ —Ç–µ–º—ã –¥–ª—è —Å–∞—Ç–∏—Ä—ã (–æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è)
CURRENT_TOPICS = [
    "–Ω–µ–π—Ä–æ—Å–µ—Ç–∏ –∑–∞—Ö–≤–∞—Ç—ã–≤–∞—é—Ç –º–∏—Ä",
    "–±–∏—Ç–∫–æ–∏–Ω —Ç–æ –ø–∞–¥–∞–µ—Ç —Ç–æ —Ä–∞—Å—Ç—ë—Ç",
    "—Å–∞–Ω–∫—Ü–∏–∏ –∏ –∏–º–ø–æ—Ä—Ç–æ–∑–∞–º–µ—â–µ–Ω–∏–µ", 
    "—É–¥–∞–ª—ë–Ω–∫–∞ vs –æ—Ñ–∏—Å",
    "–º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å—ã –∏ –ø—É–Ω–∫—Ç—ã –≤—ã–¥–∞—á–∏",
    "–ø–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ –≤—Å—ë –ø–æ–¥—Ä—è–¥",
    "–±–ª–æ–≥–µ—Ä—ã –∏ –∏–Ω—Ñ–æ—Ü—ã–≥–∞–Ω–µ",
    "–¥–æ—Å—Ç–∞–≤–∫–∞ –µ–¥—ã –∏ –∫—É—Ä—å–µ—Ä—ã",
    "—ç–ª–µ–∫—Ç—Ä–æ—Å–∞–º–æ–∫–∞—Ç—ã –≤–µ–∑–¥–µ",
    "VPN –∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏",
    "—É—Ç–µ—á–∫–∏ –¥–∞–Ω–Ω—ã—Ö",
    "–∫—Ä–µ–¥–∏—Ç—ã –∏ –∏–ø–æ—Ç–µ–∫–∞",
    "–∫–æ–º–º—É–Ω–∞–ª–∫–∞ —Ä–∞—Å—Ç—ë—Ç",
    "—Ü–µ–Ω—ã –Ω–∞ –≤—Å—ë —Ä–∞—Å—Ç—É—Ç",
    "–¥–µ—Ñ–∏—Ü–∏—Ç –∫–∞–¥—Ä–æ–≤",
    "–ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∏ –∏ –≤—ã–≥–æ—Ä–∞–Ω–∏–µ"
]

# –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å –∂–µ—Ä—Ç–≤–æ–π
VICTIM_ACTIONS = [
    "–Ω–∞—Å—Ä–∞–ª –Ω–∞", "—É–∫—É—Å–∏–ª", "–∫–ª—é–Ω—É–ª –≤ –≥–æ–ª–æ–≤—É", "–≤—Ä–µ–∑–∞–ª—Å—è –≤ –ª–∏—Ü–æ", 
    "—Å–µ–ª –Ω–∞ –≥–æ–ª–æ–≤—É", "–∑–∞–ª–µ—Ç–µ–ª –∑–∞ —à–∏–≤–æ—Ä–æ—Ç", "–ø—Ä–∏–∑–µ–º–ª–∏–ª—Å—è –Ω–∞",
    "—É–Ω–µ—Å–ª–æ —Å–∫–≤–æ–∑–Ω—è–∫–æ–º", "—Å–¥—É–ª–æ —Å–æ —Å—Ç—É–ª–∞", "–∑–∞–º–æ—Ä–æ–∑–∏–ª–æ", 
    "—É–¥–∞—Ä–∏–ª–æ –ø–æ –≥–æ–ª–æ–≤–µ", "–æ–±–ª–∏–ª–æ", "–æ–±—Å—ã–ø–∞–ª–æ", "–Ω–∞–∫—Ä—ã–ª–æ",
    "–∑–∞–ø—É—Ç–∞–ª–æ—Å—å –≤ –≤–æ–ª–æ—Å–∞—Ö —É", "—É–ø–∞–ª–æ –Ω–∞ –∫–æ–ª–µ–Ω–∏", "–≤–ª–µ—Ç–µ–ª–æ –≤ —Ä–æ—Ç"
]

# –ö–æ–Ω—Ü–æ–≤–∫–∏
ENDINGS = [
    "–ü—Ä–æ–≤–µ—Ç—Ä–µ–Ω–æ. –ù–µ –±–ª–∞–≥–æ–¥–∞—Ä–∏—Ç–µ.",
    "–°–≤–µ–∂–æ. –ú–æ–∂–µ—Ç–µ –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å.",
    "–ó–∞–∫—Ä—ã–≤–∞—é –Ω–∞—Ö—É–π, –ø–æ–∫–∞ –µ—â—ë –∫–æ–≥–æ –Ω–µ —É–±–∏–ª–æ.",
    "–í–æ—Ç –∏ –ø—Ä–æ–≤–µ—Ç—Ä–∏–ª–∏. –ö—Ç–æ —Å–ª–µ–¥—É—é—â–∏–π?",
    "–§–æ—Ä—Ç–æ—á–∫–∞ –∑–∞–∫—Ä—ã—Ç–∞. –ñ–µ—Ä—Ç–≤ –±–æ–ª—å—à–µ –Ω–µ –±—É–¥–µ—Ç. –ù–∞–≤–µ—Ä–Ω–æ–µ.",
    "–í—Å—ë, —Ö–≤–∞—Ç–∏—Ç —Å–≤–µ–∂–µ–≥–æ –≤–æ–∑–¥—É—Ö–∞ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è.",
    "–ü—Ä–æ–≤–µ—Ç—Ä–µ–Ω–æ. –ü–æ—Å—Ç—Ä–∞–¥–∞–≤—à–∏–º ‚Äî —Å–æ–±–æ–ª–µ–∑–Ω–æ–≤–∞–Ω–∏—è.",
    "–°–≤–µ–∂–∏–π –≤–æ–∑–¥—É—Ö, –≥–æ–≤–æ—Ä–∏–ª–∏ –æ–Ω–∏. –ü–æ–ª–µ–∑–Ω–æ, –≥–æ–≤–æ—Ä–∏–ª–∏ –æ–Ω–∏.",
    "–¢–∞–∫, –∑–∞–∫—Ä—ã–≤–∞—é. –ò –Ω–∏–∫–æ–º—É –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–π—Ç–µ.",
    "–ü—Ä–æ–≤–µ—Ç—Ä–∏–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ. –í—ã–∂–∏–≤—à–∏—Ö –ø—Ä–æ—Å—å–±–∞ –æ—Ç–º–µ—Ç–∏—Ç—å—Å—è.",
    "–õ–∞–¥–Ω–æ, –∑–∞–∫—Ä—ã–≤–∞—é. –ê —Ç–æ –º–∞–ª–æ –ª–∏ —á—Ç–æ –µ—â—ë –∑–∞–ª–µ—Ç–∏—Ç.",
    "–ù–∞ —Å–µ–≥–æ–¥–Ω—è —Å–≤–µ–∂–µ—Å—Ç–∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ."
]

SYSTEM_PROMPT = """–¢—ã ‚Äî –¢–Å–¢–Ø –†–û–ó–ê, –ó–õ–û–ë–ù–ê–Ø –ë–ê–ë–ö–ê-–¢–†–û–õ–õ–¨. –¢–≤–æ—è –∑–∞–¥–∞—á–∞ ‚Äî –ñ–Å–°–¢–ö–û –°–¢–ï–ë–ê–¢–¨ –∏ –£–ù–ò–ñ–ê–¢–¨ –∂–µ—Ä—Ç–≤—É –ø—Ä–∏ "–ø—Ä–æ–≤–µ—Ç—Ä–∏–≤–∞–Ω–∏–∏" —á–∞—Ç–∞.

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
üìÖ –°–ï–ì–û–î–ù–Ø: {current_date}
üéØ –ê–ö–¢–£–ê–õ–¨–ù–ê–Ø –¢–ï–ú–ê: {current_topic}
üì∞ –ö–û–ù–¢–ï–ö–°–¢: {news_context}
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

–¢–í–û–ô –°–¢–ò–õ–¨ ‚Äî –ó–õ–ê–Ø –ë–ê–ë–ö–ê –° –†–ê–ô–û–ù–ê:
- –ì–æ–≤–æ—Ä–∏—à—å –ö–ê–ö –†–ï–ê–õ–¨–ù–´–ô –ß–ï–õ–û–í–ï–ö —Å —É–ª–∏—Ü—ã
- –ò—Å–ø–æ–ª—å–∑—É–µ—à—å –°–õ–ï–ù–ì: —á–µ–ª, –∫—Ä–∏–Ω–∂, —Ä–æ—Ñ–ª, –∑–∞—à–∫–≤–∞—Ä, –¥—É—à–Ω–∏–ª–∞, –Ω–∏—â–µ–±—Ä–æ–¥, –ª–æ—Ö, —Ç–µ—Ä–ø–∏–ª–∞, –æ–≤–æ—â, –¥–Ω–∏—â–µ
- –£–ù–ò–ñ–ê–ï–®–¨ –∂–µ—Ä—Ç–≤—É: –µ—ë –≤–Ω–µ—à–Ω–æ—Å—Ç—å, –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç, –∂–∏–∑–Ω–µ–Ω–Ω—ã–µ –≤—ã–±–æ—Ä—ã, –æ–¥–∏–Ω–æ—á–µ—Å—Ç–≤–æ
- –°–¢–ï–ë–Å–®–¨–°–Ø –Ω–∞–¥ –µ—ë –Ω–µ—É–¥–∞—á–∞–º–∏, –±–µ–¥–Ω–æ—Å—Ç—å—é, —Ç—É–ø–æ—Å—Ç—å—é
- –ú–ê–¢ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π: –±–ª—è—Ç—å, —Å—É–∫–∞, –ø–∏–∑–¥–µ—Ü, –Ω–∞—Ö—É–π, —ë–±–∞–Ω—ã–π, —Ö—É–π–Ω—è, –∑–∞–ª—É–ø–∞, –º—É–¥–∞–∫

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
–ñ–ï–†–¢–í–ê –î–õ–Ø –°–¢–Å–ë–ê:
- –ò–º—è: {victim_name}
- –ü–æ–ª: {gender}
- –ß—Ç–æ –ø–∏—à–µ—Ç –≤ —á–∞—Ç–µ:
{victim_messages}
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

–§–û–†–ú–ê–¢:
ü™ü –¢—ë—Ç—è –†–æ–∑–∞ –æ—Ç–∫—Ä—ã–ª–∞ —Ñ–æ—Ä—Ç–æ—á–∫—É –≤ —á–∞—Ç–µ.

[2-3 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è: –ê–ë–°–£–†–î–ù–û–ï —Å–æ–±—ã—Ç–∏–µ + –ñ–Å–°–¢–ö–ò–ô –°–¢–Å–ë –Ω–∞–¥ –∂–µ—Ä—Ç–≤–æ–π]

[–ï–¥–∫–∞—è –∫–æ–Ω—Ü–æ–≤–∫–∞]

–°–ö–õ–û–ù–ï–ù–ò–ï –ò–ú–ï–ù–ò:
- {{VICTIM_NOM}} ‚Äî –∫—Ç–æ? (–í–∞—Å—è/–ú–∞—à–∞)
- {{VICTIM_GEN}} ‚Äî –∫–æ–≥–æ? (–í–∞—Å–∏/–ú–∞—à–∏)  
- {{VICTIM_DAT}} ‚Äî –∫–æ–º—É? (–í–∞—Å–µ/–ú–∞—à–µ)
- {{VICTIM_ACC}} ‚Äî –∫–æ–≥–æ? (–í–∞—Å—é/–ú–∞—à—É)
- {{VICTIM_INS}} ‚Äî –∫–µ–º? (–í–∞—Å–µ–π/–ú–∞—à–µ–π)
- {{VICTIM_PRE}} ‚Äî –æ –∫–æ–º? (–æ –í–∞—Å–µ/–ú–∞—à–µ)

–ü–û–õ –¥–ª—è –≥–ª–∞–≥–æ–ª–æ–≤: {gender}
- –ú—É–∂: "—ç—Ç–æ—Ç –ª–æ—Ö", "—Å–∏–¥–∏—Ç", "–æ–±–æ—Å—Ä–∞–ª—Å—è", "–ø–æ–ª—É—á–∏–ª"
- –ñ–µ–Ω: "—ç—Ç–∞ –∫—É—Ä–∏—Ü–∞", "—Å–∏–¥–∏—Ç", "–æ–±–æ—Å—Ä–∞–ª–∞—Å—å", "–ø–æ–ª—É—á–∏–ª–∞"

–ö–ê–¢–ï–ì–û–†–ò–Ø: {category}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
–ü–†–ò–ú–ï–†–´ –î–õ–Ø –ú–£–ñ–ß–ò–ù (–ø–æ–ª = –º—É–∂—Å–∫–æ–π):
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

ü™ü –¢—ë—Ç—è –†–æ–∑–∞ –æ—Ç–∫—Ä—ã–ª–∞ —Ñ–æ—Ä—Ç–æ—á–∫—É –≤ —á–∞—Ç–µ.

–ó–∞–ª–µ—Ç–µ–ª –≥–æ–ª—É–±—å, –ø–æ—Å–º–æ—Ç—Ä–µ–ª –Ω–∞ {{VICTIM_ACC}} –∏ —Å—Ä–∞–∑—É –æ–±–æ—Å—Ä–∞–ª—Å—è. {{VICTIM_NOM}} —Å–∏–¥–∏—Ç –æ–±–æ—Å—Ä–∞–Ω–Ω—ã–π, –Ω–æ –Ω–µ –ø–æ–Ω–∏–º–∞–µ—Ç —á—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å ‚Äî –æ–Ω –∏ –¥–æ —ç—Ç–æ–≥–æ –≤—ã–≥–ª—è–¥–µ–ª –∫–∞–∫ –≥–æ–≤–Ω–æ.

–°–≤–µ–∂–æ. –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç {{VICTIM_GEN}}.

---

ü™ü –¢—ë—Ç—è –†–æ–∑–∞ –æ—Ç–∫—Ä—ã–ª–∞ —Ñ–æ—Ä—Ç–æ—á–∫—É –≤ —á–∞—Ç–µ.

–°–∫–≤–æ–∑–Ω—è–∫–æ–º —É–Ω–µ—Å–ª–æ –ø–æ—Å–ª–µ–¥–Ω–∏–µ –¥–≤–∞ –Ω–µ–π—Ä–æ–Ω–∞ {{VICTIM_GEN}}. –¢–µ–ø–µ—Ä—å —ç—Ç–æ—Ç –æ–≤–æ—â –º–æ–∂–µ—Ç –æ—Ñ–æ—Ä–º–∏—Ç—å –∏–Ω–≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å –ø–æ —Ç—É–ø–æ—Å—Ç–∏. {{VICTIM_NOM}} —Ä–∞–¥ ‚Äî –≤ –≥–æ–ª–æ–≤–µ —Å–≤–æ–±–æ–¥–Ω–æ.

–ü—Ä–æ–≤–µ—Ç—Ä–µ–Ω–æ. –ú–æ–∑–≥–∏ –Ω–µ –Ω–∞—à–ª–∏—Å—å.

---

ü™ü –¢—ë—Ç—è –†–æ–∑–∞ –æ—Ç–∫—Ä—ã–ª–∞ —Ñ–æ—Ä—Ç–æ—á–∫—É –≤ —á–∞—Ç–µ.

–ü—Ä–∏–ª–µ—Ç–µ–ª–∞ –ø—Ç–∏—Ü–∞ —Å—á–∞—Å—Ç—å—è, —É–≤–∏–¥–µ–ª–∞ {{VICTIM_ACC}} –∏ —Å—Ä–∞–∑—É —É–ª–µ—Ç–µ–ª–∞ –Ω–∞—Ö—É–π. {{VICTIM_NOM}} –æ—Å—Ç–∞–ª—Å—è –∂–¥–∞—Ç—å. –ñ–¥—ë—Ç —Å 2007 –≥–æ–¥–∞.

–û–ø—Ç–∏–º–∏–∑–º, –±–ª—è—Ç—å.

---

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
–ü–†–ò–ú–ï–†–´ –î–õ–Ø –ñ–ï–ù–©–ò–ù (–ø–æ–ª = –∂–µ–Ω—Å–∫–∏–π):
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

ü™ü –¢—ë—Ç—è –†–æ–∑–∞ –æ—Ç–∫—Ä—ã–ª–∞ —Ñ–æ—Ä—Ç–æ—á–∫—É –≤ —á–∞—Ç–µ.

–ó–∞–ª–µ—Ç–µ–ª –≥–æ–ª—É–±—å, –ø–æ—Å–º–æ—Ç—Ä–µ–ª –Ω–∞ {{VICTIM_ACC}} –∏ —Å—Ä–∞–∑—É –æ–±–æ—Å—Ä–∞–ª—Å—è ‚Äî –≤–∏–¥–∏–º–æ, –æ—Ç —É–∂–∞—Å–∞. {{VICTIM_NOM}} —Å–∏–¥–∏—Ç –æ–±–æ—Å—Ä–∞–Ω–Ω–∞—è, –Ω–æ –µ–π –Ω–µ –ø—Ä–∏–≤—ã–∫–∞—Ç—å ‚Äî –≤—Å—è –µ—ë –∂–∏–∑–Ω—å –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫ –∏ –≤—ã–≥–ª—è–¥–∏—Ç.

–°–≤–µ–∂–æ. –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç –æ—Ç–Ω–æ—à–µ–Ω–∏–π {{VICTIM_GEN}}.

---

ü™ü –¢—ë—Ç—è –†–æ–∑–∞ –æ—Ç–∫—Ä—ã–ª–∞ —Ñ–æ—Ä—Ç–æ—á–∫—É –≤ —á–∞—Ç–µ.

–°–∫–≤–æ–∑–Ω—è–∫–æ–º —É–Ω–µ—Å–ª–æ –ø–æ—Å–ª–µ–¥–Ω—é—é –Ω–∞–¥–µ–∂–¥—É {{VICTIM_GEN}} –Ω–∞ —Å—á–∞—Å—Ç–ª–∏–≤—É—é –ª–∏—á–Ω—É—é –∂–∏–∑–Ω—å. {{VICTIM_NOM}} –æ—Å—Ç–∞–ª–∞—Å—å –æ–¥–Ω–∞. –û–ø—è—Ç—å. –ö–∞–∫ –æ–±—ã—á–Ω–æ. –ù–∞–¥–µ–∂–¥–∞ —É–ª–µ—Ç–µ–ª–∞ –≤ —Å—Ç–æ—Ä–æ–Ω—É –ë—É—Ç–æ–≤–æ.

–°–≤–µ–∂–∏–π –≤–æ–∑–¥—É—Ö, —Å–≤–µ–∂–∏–µ —Å–ª—ë–∑—ã.

---

ü™ü –¢—ë—Ç—è –†–æ–∑–∞ –æ—Ç–∫—Ä—ã–ª–∞ —Ñ–æ—Ä—Ç–æ—á–∫—É –≤ —á–∞—Ç–µ.

–í–ª–µ—Ç–µ–ª —á–µ–π-—Ç–æ –±—ã–≤—à–∏–π. –ü–æ—Å–º–æ—Ç—Ä–µ–ª –Ω–∞ {{VICTIM_ACC}}, –≤—Å–ø–æ–º–Ω–∏–ª –ø–æ—á–µ–º—É —É—à—ë–ª, –∏ –≤—ã–ª–µ—Ç–µ–ª –æ–±—Ä–∞—Ç–Ω–æ. {{VICTIM_NOM}} –ø—Ä–∏–≤—ã–∫–ª–∞ ‚Äî —ç—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è —Ä–µ–∞–∫—Ü–∏—è –º—É–∂—á–∏–Ω –Ω–∞ –µ—ë —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ.

–ú—É–∂–∏–∫–∏ –∑–Ω–∞—é—Ç. –¢—ë—Ç—è –†–æ–∑–∞ —Ç–æ–∂–µ.

---

ü™ü –¢—ë—Ç—è –†–æ–∑–∞ –æ—Ç–∫—Ä—ã–ª–∞ —Ñ–æ—Ä—Ç–æ—á–∫—É –≤ —á–∞—Ç–µ.

–í–µ—Ç—Ä–æ–º –∑–∞–Ω–µ—Å–ª–æ —Ä–µ–∑—é–º–µ {{VICTIM_GEN}}. –Ø –ø—Ä–æ—á–∏—Ç–∞–ª–∞ ‚Äî –æ—Ö—É–µ–ª–∞. –≠—Ç–æ–π –∫—É—Ä–∏—Ü–µ –Ω–µ —Ç–æ —á—Ç–æ —Ä–∞–±–æ—Ç—É, –µ–π –±—ã –º—É–∂–∏–∫–∞ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ –Ω–∞–π—Ç–∏. –ù–æ —Å —Ç–∞–∫–∏–º —Ä–µ–∑—é–º–µ ‚Äî —Ö—É–π —Ç–∞–º.

HR-–æ—Ç–¥–µ–ª –∞–¥–∞ —É–∂–µ –∑–≤–æ–Ω–∏—Ç.

---

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û ‚Äî –°–û–ì–õ–ê–°–û–í–ê–ù–ò–ï –ü–û –ü–û–õ–£:
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
–ï—Å–ª–∏ –ø–æ–ª = –ú–£–ñ–°–ö–û–ô:
- "–æ–Ω", "—ç—Ç–æ—Ç –ª–æ—Ö", "—Å–∏–¥–∏—Ç –æ–±–æ—Å—Ä–∞–Ω–Ω—ã–π", "–æ—Å—Ç–∞–ª—Å—è", "–ø—Ä–∏–≤—ã–∫", "–æ—Ö—É–µ–ª"

–ï—Å–ª–∏ –ø–æ–ª = –ñ–ï–ù–°–ö–ò–ô:
- "–æ–Ω–∞", "—ç—Ç–∞ –∫—É—Ä–∏—Ü–∞", "—Å–∏–¥–∏—Ç –æ–±–æ—Å—Ä–∞–Ω–Ω–∞—è", "–æ—Å—Ç–∞–ª–∞—Å—å", "–ø—Ä–∏–≤—ã–∫–ª–∞", "–æ—Ö—É–µ–ª–∞"

---

ü™ü –¢—ë—Ç—è –†–æ–∑–∞ –æ—Ç–∫—Ä—ã–ª–∞ —Ñ–æ—Ä—Ç–æ—á–∫—É –≤ —á–∞—Ç–µ.

–°–∫–≤–æ–∑–Ω—è–∫–æ–º —Å–¥—É–ª–æ —Å {{VICTIM_GEN}} –º–∞—Å–∫—É –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞. –ü–æ–¥ –Ω–µ–π –æ–∫–∞–∑–∞–ª–æ—Å—å —Ç–æ, —á—Ç–æ –º—ã –≤—Å–µ –ø–æ–¥–æ–∑—Ä–µ–≤–∞–ª–∏ ‚Äî –¥–µ–ø—Ä–µ—Å—Å–∏–≤–Ω—ã–π –∑–∞–¥—Ä–æ—Ç —Å –∞–Ω–∏–º–µ-–ø–æ–¥—É—à–∫–æ–π –∏ —Ç—Ä–µ–º—è –∫—Ä–µ–¥–∏—Ç–∞–º–∏ –Ω–∞ –¥–æ–Ω–∞—Ç –≤ –≥–∞—á—É.

–≠—Ç–æ –ª–µ—á–∏—Ç—Å—è. –ù–æ –¥–æ—Ä–æ–≥–æ.

---

ü™ü –¢—ë—Ç—è –†–æ–∑–∞ –æ—Ç–∫—Ä—ã–ª–∞ —Ñ–æ—Ä—Ç–æ—á–∫—É –≤ —á–∞—Ç–µ.

–ó–∞–ª–µ—Ç–µ–ª –∫–æ–º–∞—Ä. –£–∫—É—Å–∏–ª {{VICTIM_ACC}} –∏ —Å–¥–æ—Ö ‚Äî –æ—Ç—Ä–∞–≤–∏–ª—Å—è. {{VICTIM_NOM}} —Ç–∞–∫–æ–µ —Ç–æ–∫—Å–∏—á–Ω–æ–µ —Å—É—â–µ—Å—Ç–≤–æ, —á—Ç–æ –¥–∞–∂–µ –∫–æ–º–∞—Ä—ã –Ω–µ –≤—ã–¥–µ—Ä–∂–∏–≤–∞—é—Ç. –ó–∞—Ç–æ —É –Ω–µ–≥–æ –∏–º–º—É–Ω–∏—Ç–µ—Ç ‚Äî –∫ —É—Å–ø–µ—Ö—É, —Å—á–∞—Å—Ç—å—é –∏ –Ω–æ—Ä–º–∞–ª—å–Ω—ã–º –æ—Ç–Ω–æ—à–µ–Ω–∏—è–º.

–≠–≤–æ–ª—é—Ü–∏—è, —Å—É–∫–∞.

---

–¢–ï–ü–ï–†–¨ –£–ù–ò–ß–¢–û–ñ–¨ {victim_name} ({gender})!
–¢–µ–º–∞ –¥–ª—è —Å—Ç—ë–±–∞: {current_topic}
–ë—É–¥—å –ñ–Å–°–¢–ö–ò–ú, –ó–õ–´–ú, –∏—Å–ø–æ–ª—å–∑—É–π –°–õ–ï–ù–ì! –°—Ç–µ–±–∏—Å—å –Ω–∞–¥ —Ç—É–ø–æ—Å—Ç—å—é, –Ω–∏—â–µ—Ç–æ–π, –æ–¥–∏–Ω–æ—á–µ—Å—Ç–≤–æ–º!"""


def fetch_news_headlines() -> str:
    """–ü–æ–ª—É—á–∏—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –Ω–æ–≤–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ DuckDuckGo (–±–µ–∑ API –∫–ª—é—á–∞)"""
    try:
        # –ü—Ä–æ—Å—Ç–æ–π –∑–∞–ø—Ä–æ—Å –∫ DuckDuckGo news
        url = "https://duckduckgo.com/news.js?q=—Ä–æ—Å—Å–∏—è+–Ω–æ–≤–æ—Å—Ç–∏&kl=ru-ru"
        req = urllib.request.Request(
            url,
            headers={'User-Agent': 'Mozilla/5.0'}
        )
        with urllib.request.urlopen(req, timeout=3) as response:
            # –ü–∞—Ä—Å–∏–º –æ—Ç–≤–µ—Ç (—ç—Ç–æ –Ω–µ –≤—Å–µ–≥–¥–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç, –ø–æ—ç—Ç–æ–º—É fallback)
            data = response.read().decode('utf-8')
            # –ò–∑–≤–ª–µ–∫–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏ –µ—Å–ª–∏ –ø–æ–ª—É—á–∏–ª–æ—Å—å
            if 'headline' in data.lower():
                return data[:500]
    except:
        pass
    
    # Fallback ‚Äî –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º "–Ω–æ–≤–æ—Å—Ç–∏" –∏–∑ –∞–∫—Ç—É–∞–ª—å–Ω—ã—Ö —Ç–µ–º
    fake_news = [
        "–ö—É—Ä—Å –¥–æ–ª–ª–∞—Ä–∞ —Å–Ω–æ–≤–∞ —É–¥–∏–≤–∏–ª —ç–∫—Å–ø–µ—Ä—Ç–æ–≤",
        "–ù–µ–π—Ä–æ—Å–µ—Ç–∏ –Ω–∞—É—á–∏–ª–∏—Å—å –ø–∏—Å–∞—Ç—å –∑–∞ –ª—é–¥–µ–π", 
        "–¶–µ–Ω—ã –Ω–∞ –ø—Ä–æ–¥—É–∫—Ç—ã –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç —Ä–∞—Å—Ç–∏",
        "–ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å—ã –∑–∞—Ö–≤–∞—Ç—ã–≤–∞—é—Ç —Ä—ã–Ω–æ–∫",
        "–£–¥–∞–ª—ë–Ω–∫–∞ –æ—Å—Ç–∞—ë—Ç—Å—è —Ç—Ä–µ–Ω–¥–æ–º",
        "–ë–ª–æ–≥–µ—Ä—ã –∑–∞—Ä–∞–±–æ—Ç–∞–ª–∏ –±–æ–ª—å—à–µ –Ω–µ—Ñ—Ç—è–Ω–∏–∫–æ–≤",
        "–ö—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–∞ –æ–ø—è—Ç—å –æ–±–≤–∞–ª–∏–ª–∞—Å—å",
        "VPN —Å—Ç–∞–ª –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å—é",
        "–ö—É—Ä—å–µ—Ä—ã –Ω–∞ —Å–∞–º–æ–∫–∞—Ç–∞—Ö –∞—Ç–∞–∫—É—é—Ç –≥–æ—Ä–æ–¥–∞",
        "–ü–æ–¥–ø–∏—Å–∫–∏ —Å—ä–µ–¥–∞—é—Ç –±—é–¥–∂–µ—Ç—ã —Ä–æ—Å—Å–∏—è–Ω"
    ]
    return random.choice(fake_news)


def get_current_date_ru() -> str:
    """–ü–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â—É—é –¥–∞—Ç—É –Ω–∞ —Ä—É—Å—Å–∫–æ–º"""
    months = {
        1: '—è–Ω–≤–∞—Ä—è', 2: '—Ñ–µ–≤—Ä–∞–ª—è', 3: '–º–∞—Ä—Ç–∞', 4: '–∞–ø—Ä–µ–ª—è',
        5: '–º–∞—è', 6: '–∏—é–Ω—è', 7: '–∏—é–ª—è', 8: '–∞–≤–≥—É—Å—Ç–∞',
        9: '—Å–µ–Ω—Ç—è–±—Ä—è', 10: '–æ–∫—Ç—è–±—Ä—è', 11: '–Ω–æ—è–±—Ä—è', 12: '–¥–µ–∫–∞–±—Ä—è'
    }
    days = {
        0: '–ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫', 1: '–≤—Ç–æ—Ä–Ω–∏–∫', 2: '—Å—Ä–µ–¥–∞', 3: '—á–µ—Ç–≤–µ—Ä–≥',
        4: '–ø—è—Ç–Ω–∏—Ü–∞', 5: '—Å—É–±–±–æ—Ç–∞', 6: '–≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ'
    }
    now = datetime.now()
    return f"{now.day} {months[now.month]} {now.year}, {days[now.weekday()]}"


def detect_gender_from_messages(messages: list, name: str) -> str:
    """–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ–ª–∞ –ø–æ —Å–æ–æ–±—â–µ–Ω–∏—è–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ‚Äî –†–ê–°–®–ò–†–ï–ù–ù–ê–Ø –í–ï–†–°–ò–Ø"""
    
    # –ñ–µ–Ω—Å–∫–∏–µ –º–∞—Ä–∫–µ—Ä—ã ‚Äî –≥–ª–∞–≥–æ–ª—ã –ø—Ä–æ—à–µ–¥—à–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ (–æ–∫–æ–Ω—á–∞–Ω–∏–µ -–ª–∞, -–ª–∞—Å—å)
    FEMALE_VERB_MARKERS = [
        # –û—Å–Ω–æ–≤–Ω—ã–µ –≥–ª–∞–≥–æ–ª—ã
        '—Å–¥–µ–ª–∞–ª–∞', '–ø–æ—à–ª–∞', '–±—ã–ª–∞', '—Ö–æ—Ç–µ–ª–∞', '–º–æ–≥–ª–∞', '–∑–Ω–∞–ª–∞', '–≤–∏–¥–µ–ª–∞',
        '–Ω–∞–ø–∏—Å–∞–ª–∞', '—Å–∫–∞–∑–∞–ª–∞', '–¥—É–º–∞–ª–∞', '—Ä–µ—à–∏–ª–∞', '–ø–æ–Ω—è–ª–∞', '–≤–∑—è–ª–∞',
        '–ø—Ä–∏—à–ª–∞', '—É—à–ª–∞', '–Ω–∞—à–ª–∞', '–ø–æ—Ç–µ—Ä—è–ª–∞', '–∫—É–ø–∏–ª–∞', '–ø—Ä–æ–¥–∞–ª–∞',
        '–ø–∏–ª–∞', '–µ–ª–∞', '—Å–ø–∞–ª–∞', '—á–∏—Ç–∞–ª–∞', '—Å–º–æ—Ç—Ä–µ–ª–∞', '—Å–ª—É—à–∞–ª–∞',
        '—Ä–∞–±–æ—Ç–∞–ª–∞', '—É—á–∏–ª–∞—Å—å', '–∂–∏–ª–∞', '–ª—é–±–∏–ª–∞', '–Ω–µ–Ω–∞–≤–∏–¥–µ–ª–∞',
        '—Ö–æ–¥–∏–ª–∞', '–±–µ–≥–∞–ª–∞', '–ª–µ—Ç–∞–ª–∞', '–µ–∑–¥–∏–ª–∞', '–ø–ª–∞–≤–∞–ª–∞',
        '–∏–≥—Ä–∞–ª–∞', '–ø–µ–ª–∞', '—Ç–∞–Ω—Ü–µ–≤–∞–ª–∞', '—Ä–∏—Å–æ–≤–∞–ª–∞', '–ø–∏—Å–∞–ª–∞',
        '–≥–æ—Ç–æ–≤–∏–ª–∞', '—É–±–∏—Ä–∞–ª–∞', '—Å—Ç–∏—Ä–∞–ª–∞', '–º—ã–ª–∞', '—á–∏—Å—Ç–∏–ª–∞',
        '–∑–≤–æ–Ω–∏–ª–∞', '–æ—Ç–≤–µ—á–∞–ª–∞', '—Å–ø—Ä–∞—à–∏–≤–∞–ª–∞', '–ø—Ä–æ—Å–∏–ª–∞', '—Ç—Ä–µ–±–æ–≤–∞–ª–∞',
        '–∂–¥–∞–ª–∞', '–Ω–∞–¥–µ—è–ª–∞—Å—å', '–≤–µ—Ä–∏–ª–∞', '–º–µ—á—Ç–∞–ª–∞', '–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–ª–∞',
        '—Å–º–µ—è–ª–∞—Å—å', '–ø–ª–∞–∫–∞–ª–∞', '—Ä–∞–¥–æ–≤–∞–ª–∞—Å—å', '–≥—Ä—É—Å—Ç–∏–ª–∞', '–∑–ª–∏–ª–∞—Å—å',
        '–±–æ—è–ª–∞—Å—å', '–≤–æ–ª–Ω–æ–≤–∞–ª–∞—Å—å', '–ø–µ—Ä–µ–∂–∏–≤–∞–ª–∞', '—É—Å–ø–æ–∫–æ–∏–ª–∞—Å—å',
        '–ø—Ä–æ—Å–Ω—É–ª–∞—Å—å', '—É—Å–Ω—É–ª–∞', '–ª–µ–≥–ª–∞', '–≤—Å—Ç–∞–ª–∞', '—Å–µ–ª–∞',
        '–æ–¥–µ–ª–∞—Å—å', '—Ä–∞–∑–¥–µ–ª–∞—Å—å', '–ø–æ–º—ã–ª–∞—Å—å', '–Ω–∞–∫—Ä–∞—Å–∏–ª–∞—Å—å', '–ø—Ä–∏—á–µ—Å–∞–ª–∞—Å—å',
        '–≤–ª—é–±–∏–ª–∞—Å—å', '–≤—ã—à–ª–∞ –∑–∞–º—É–∂', '—Ä–∞–∑–≤–µ–ª–∞—Å—å', '—Ä–æ–¥–∏–ª–∞',
        '–∑–∞–±–æ–ª–µ–ª–∞', '–≤—ã–∑–¥–æ—Ä–æ–≤–µ–ª–∞', '–ø–æ—Ö—É–¥–µ–ª–∞', '–ø–æ–ø—Ä–∞–≤–∏–ª–∞—Å—å',
        '–æ–ø–æ–∑–¥–∞–ª–∞', '—É—Å–ø–µ–ª–∞', '–∑–∞–±—ã–ª–∞', '–≤—Å–ø–æ–º–Ω–∏–ª–∞', '—É–∑–Ω–∞–ª–∞',
        '–ø–æ–µ—Ö–∞–ª–∞', '–ø—Ä–∏–µ—Ö–∞–ª–∞', '—É–µ—Ö–∞–ª–∞', '–≤–µ—Ä–Ω—É–ª–∞—Å—å', '–æ—Å—Ç–∞–ª–∞—Å—å',
        '–Ω–∞—á–∞–ª–∞', '–∑–∞–∫–æ–Ω—á–∏–ª–∞', '–ø—Ä–æ–¥–æ–ª–∂–∏–ª–∞', '–±—Ä–æ—Å–∏–ª–∞', '–ø–æ–ø—Ä–æ–±–æ–≤–∞–ª–∞',
        '–ø–æ–ª—É—á–∏–ª–∞', '–æ—Ç–¥–∞–ª–∞', '–ø–æ–¥–∞—Ä–∏–ª–∞', '–≤—ã–∏–≥—Ä–∞–ª–∞', '–ø—Ä–æ–∏–≥—Ä–∞–ª–∞',
        # –í–æ–∑–≤—Ä–∞—Ç–Ω—ã–µ –≥–ª–∞–≥–æ–ª—ã
        '—É–¥–∏–≤–∏–ª–∞—Å—å', '–æ–±—Ä–∞–¥–æ–≤–∞–ª–∞—Å—å', '—Ä–∞—Å—Å—Ç—Ä–æ–∏–ª–∞—Å—å', '—Ä–∞–∑–æ–∑–ª–∏–ª–∞—Å—å',
        '–∏—Å–ø—É–≥–∞–ª–∞—Å—å', '–æ–±–∏–¥–µ–ª–∞—Å—å', '–≤–ª—é–±–∏–ª–∞—Å—å', '—Ä–∞–∑–ª—é–±–∏–ª–∞',
        '–æ—à–∏–±–ª–∞—Å—å', '–∏—Å–ø—Ä–∞–≤–∏–ª–∞—Å—å', '–∏–∑–º–µ–Ω–∏–ª–∞—Å—å', '–æ—Å—Ç–∞–ª–∞—Å—å',
        '—Å–æ–≥–ª–∞—Å–∏–ª–∞—Å—å', '–æ—Ç–∫–∞–∑–∞–ª–∞—Å—å', '—Ä–µ—à–∏–ª–∞—Å—å', '–ø–æ—Å—Ç–∞—Ä–∞–ª–∞—Å—å',
        # –ö—Ä–∞—Ç–∫–∏–µ –ø—Ä–∏—á–∞—Å—Ç–∏—è
        '–∑–∞–Ω—è—Ç–∞', '—É–≤–ª–µ—á–µ–Ω–∞', '–≤–ª—é–±–ª–µ–Ω–∞', '–∑–∞–º—É–∂–µ–º', '—Ä–∞–∑–≤–µ–¥–µ–Ω–∞',
        '–æ–¥–µ—Ç–∞', '—Ä–∞–∑–¥–µ—Ç–∞', '–Ω–∞–∫—Ä–∞—à–µ–Ω–∞', '–ø—Ä–∏—á—ë—Å–∞–Ω–∞',
    ]
    
    # –ñ–µ–Ω—Å–∫–∏–µ –ø—Ä–∏–ª–∞–≥–∞—Ç–µ–ª—å–Ω—ã–µ –∏ —Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ
    FEMALE_ADJ_MARKERS = [
        '—Ä–∞–¥–∞', '—É—Å—Ç–∞–ª–∞', '–≥–æ—Ç–æ–≤–∞', '–¥–æ–≤–æ–ª—å–Ω–∞', '—Å—á–∞—Å—Ç–ª–∏–≤–∞', '–Ω–µ—Å—á–∞—Å—Ç–Ω–∞',
        '–∑–ª–∞—è', '–¥–æ–±—Ä–∞—è', '–≤–µ—Å—ë–ª–∞—è', '–≥—Ä—É—Å—Ç–Ω–∞—è', '–∫—Ä–∞—Å–∏–≤–∞—è', '—É–º–Ω–∞—è',
        '–≥–ª—É–ø–∞—è', '—Å–∏–ª—å–Ω–∞—è', '—Å–ª–∞–±–∞—è', '–±–æ–ª—å–Ω–∞—è', '–∑–¥–æ—Ä–æ–≤–∞—è',
        '–º–æ–ª–æ–¥–∞—è', '—Å—Ç–∞—Ä–∞—è', '–≤—ã—Å–æ–∫–∞—è', '–Ω–∏–∑–∫–∞—è', '—Ç–æ–ª—Å—Ç–∞—è', '—Ö—É–¥–∞—è',
        '–±–µ—Ä–µ–º–µ–Ω–Ω–∞', '–∑–∞–º—É–∂–Ω—è—è', '—Ä–∞–∑–≤–µ–¥—ë–Ω–Ω–∞—è', '–æ–¥–∏–Ω–æ–∫–∞—è',
        '–≥–æ–ª–æ–¥–Ω–∞—è', '—Å—ã—Ç–∞—è', '–ø—å—è–Ω–∞—è', '—Ç—Ä–µ–∑–≤–∞—è', '—É—Å—Ç–∞–≤—à–∞—è',
        '–∑–∞–Ω—è—Ç–∞—è', '—Å–≤–æ–±–æ–¥–Ω–∞—è', '–±–æ–≥–∞—Ç–∞—è', '–±–µ–¥–Ω–∞—è',
    ]
    
    # –ñ–µ–Ω—Å–∫–∏–µ —Ñ—Ä–∞–∑—ã-–∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã
    FEMALE_PHRASES = [
        '—è –¥–µ–≤—É—à–∫–∞', '—è –∂–µ–Ω—â–∏–Ω–∞', '—è –º–∞–º–∞', '—è –∂–µ–Ω–∞', '—è –±–∞–±—É—à–∫–∞',
        '—è –¥–µ–≤–æ—á–∫–∞', '—è —Ç—ë—Ç—è', '—è —Å–µ—Å—Ç—Ä–∞', '—è –¥–æ—á—å', '—è –ø–æ–¥—Ä—É–≥–∞',
        '–∫–∞–∫ –±–∞–±–∞', '–∫–∞–∫ –¥–µ–≤–∫–∞', '–∫–∞–∫ –∂–µ–Ω—â–∏–Ω–∞', '–∫–∞–∫ –º–∞–º–∞',
        '–º–æ–π –º—É–∂', '–º–æ–π –ø–∞—Ä–µ–Ω—å', '–º–æ–π –º—É–∂—á–∏–Ω–∞', '–º–æ–π –±—ã–≤—à–∏–π',
        '—É –º–µ–Ω—è –º–µ—Å—è—á–Ω—ã–µ', '—É –º–µ–Ω—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –¥–Ω–∏', '–ø–º—Å',
        '–º–∞–Ω–∏–∫—é—Ä', '–ø–µ–¥–∏–∫—é—Ä', '—ç–ø–∏–ª—è—Ü–∏—è', '–º–∞–∫–∏—è–∂', '–∫–æ—Å–º–µ—Ç–∏–∫–∞',
        '–ø–ª–∞—Ç—å–µ', '—é–±–∫–∞', '–∫–∞–±–ª—É–∫–∏', '—Ç—É—Ñ–ª–∏', '—Å—É–º–æ—á–∫–∞',
        '—Ä–æ–∂–∞–ª–∞', '–∫–æ—Ä–º–∏–ª–∞ –≥—Ä—É–¥—å—é', '–±–µ—Ä–µ–º–µ–Ω–Ω–∞—è',
    ]
    
    # –ú—É–∂—Å–∫–∏–µ –º–∞—Ä–∫–µ—Ä—ã ‚Äî –≥–ª–∞–≥–æ–ª—ã –ø—Ä–æ—à–µ–¥—à–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
    MALE_VERB_MARKERS = [
        # –û—Å–Ω–æ–≤–Ω—ã–µ –≥–ª–∞–≥–æ–ª—ã
        '—Å–¥–µ–ª–∞–ª', '–ø–æ—à—ë–ª', '–ø–æ—à–µ–ª', '–±—ã–ª', '—Ö–æ—Ç–µ–ª', '–º–æ–≥', '–∑–Ω–∞–ª', '–≤–∏–¥–µ–ª',
        '–Ω–∞–ø–∏—Å–∞–ª', '—Å–∫–∞–∑–∞–ª', '–¥—É–º–∞–ª', '—Ä–µ—à–∏–ª', '–ø–æ–Ω—è–ª', '–≤–∑—è–ª',
        '–ø—Ä–∏—à—ë–ª', '–ø—Ä–∏—à–µ–ª', '—É—à—ë–ª', '—É—à–µ–ª', '–Ω–∞—à—ë–ª', '–Ω–∞—à–µ–ª', '–ø–æ—Ç–µ—Ä—è–ª',
        '–ø–∏–ª', '–µ–ª', '—Å–ø–∞–ª', '—á–∏—Ç–∞–ª', '—Å–º–æ—Ç—Ä–µ–ª', '—Å–ª—É—à–∞–ª',
        '—Ä–∞–±–æ—Ç–∞–ª', '—É—á–∏–ª—Å—è', '–∂–∏–ª', '–ª—é–±–∏–ª', '–Ω–µ–Ω–∞–≤–∏–¥–µ–ª',
        '—Ö–æ–¥–∏–ª', '–±–µ–≥–∞–ª', '–ª–µ—Ç–∞–ª', '–µ–∑–¥–∏–ª', '–ø–ª–∞–≤–∞–ª',
        '–∏–≥—Ä–∞–ª', '–ø–µ–ª', '—Ç–∞–Ω—Ü–µ–≤–∞–ª', '—Ä–∏—Å–æ–≤–∞–ª', '–ø–∏—Å–∞–ª',
        '–≥–æ—Ç–æ–≤–∏–ª', '—É–±–∏—Ä–∞–ª', '—á–∏–Ω–∏–ª', '—Å—Ç—Ä–æ–∏–ª', '—Ä–µ–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–ª',
        '–∑–≤–æ–Ω–∏–ª', '–æ—Ç–≤–µ—á–∞–ª', '—Å–ø—Ä–∞—à–∏–≤–∞–ª', '–ø—Ä–æ—Å–∏–ª', '—Ç—Ä–µ–±–æ–≤–∞–ª',
        '–∂–¥–∞–ª', '–Ω–∞–¥–µ—è–ª—Å—è', '–≤–µ—Ä–∏–ª', '–º–µ—á—Ç–∞–ª', '–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–ª',
        '—Å–º–µ—è–ª—Å—è', '–ø–ª–∞–∫–∞–ª', '—Ä–∞–¥–æ–≤–∞–ª—Å—è', '–≥—Ä—É—Å—Ç–∏–ª', '–∑–ª–∏–ª—Å—è',
        '–±–æ—è–ª—Å—è', '–≤–æ–ª–Ω–æ–≤–∞–ª—Å—è', '–ø–µ—Ä–µ–∂–∏–≤–∞–ª', '—É—Å–ø–æ–∫–æ–∏–ª—Å—è',
        '–ø—Ä–æ—Å–Ω—É–ª—Å—è', '—É—Å–Ω—É–ª', '–ª—ë–≥', '–≤—Å—Ç–∞–ª', '—Å–µ–ª',
        '–æ–¥–µ–ª—Å—è', '—Ä–∞–∑–¥–µ–ª—Å—è', '–ø–æ–º—ã–ª—Å—è', '–ø–æ–±—Ä–∏–ª—Å—è',
        '–≤–ª—é–±–∏–ª—Å—è', '–∂–µ–Ω–∏–ª—Å—è', '—Ä–∞–∑–≤—ë–ª—Å—è', '—Ä–∞—Å—Å—Ç–∞–ª—Å—è',
        '–∑–∞–±–æ–ª–µ–ª', '–≤—ã–∑–¥–æ—Ä–æ–≤–µ–ª', '–ø–æ—Ö—É–¥–µ–ª', '–ø–æ–ø—Ä–∞–≤–∏–ª—Å—è',
        '–æ–ø–æ–∑–¥–∞–ª', '—É—Å–ø–µ–ª', '–∑–∞–±—ã–ª', '–≤—Å–ø–æ–º–Ω–∏–ª', '—É–∑–Ω–∞–ª',
        '–ø–æ–µ—Ö–∞–ª', '–ø—Ä–∏–µ—Ö–∞–ª', '—É–µ—Ö–∞–ª', '–≤–µ—Ä–Ω—É–ª—Å—è', '–æ—Å—Ç–∞–ª—Å—è',
        '–Ω–∞—á–∞–ª', '–∑–∞–∫–æ–Ω—á–∏–ª', '–ø—Ä–æ–¥–æ–ª–∂–∏–ª', '–±—Ä–æ—Å–∏–ª', '–ø–æ–ø—Ä–æ–±–æ–≤–∞–ª',
        '–ø–æ–ª—É—á–∏–ª', '–æ—Ç–¥–∞–ª', '–ø–æ–¥–∞—Ä–∏–ª', '–≤—ã–∏–≥—Ä–∞–ª', '–ø—Ä–æ–∏–≥—Ä–∞–ª',
        # –í–æ–∑–≤—Ä–∞—Ç–Ω—ã–µ –≥–ª–∞–≥–æ–ª—ã
        '—É–¥–∏–≤–∏–ª—Å—è', '–æ–±—Ä–∞–¥–æ–≤–∞–ª—Å—è', '—Ä–∞—Å—Å—Ç—Ä–æ–∏–ª—Å—è', '—Ä–∞–∑–æ–∑–ª–∏–ª—Å—è',
        '–∏—Å–ø—É–≥–∞–ª—Å—è', '–æ–±–∏–¥–µ–ª—Å—è', '–≤–ª—é–±–∏–ª—Å—è', '—Ä–∞–∑–ª—é–±–∏–ª',
        '–æ—à–∏–±—Å—è', '–∏—Å–ø—Ä–∞–≤–∏–ª—Å—è', '–∏–∑–º–µ–Ω–∏–ª—Å—è', '–æ—Å—Ç–∞–ª—Å—è',
        '—Å–æ–≥–ª–∞—Å–∏–ª—Å—è', '–æ—Ç–∫–∞–∑–∞–ª—Å—è', '—Ä–µ—à–∏–ª—Å—è', '–ø–æ—Å—Ç–∞—Ä–∞–ª—Å—è',
    ]
    
    # –ú—É–∂—Å–∫–∏–µ –ø—Ä–∏–ª–∞–≥–∞—Ç–µ–ª—å–Ω—ã–µ –∏ —Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ
    MALE_ADJ_MARKERS = [
        '—Ä–∞–¥', '—É—Å—Ç–∞–ª', '–≥–æ—Ç–æ–≤', '–¥–æ–≤–æ–ª–µ–Ω', '—Å—á–∞—Å—Ç–ª–∏–≤', '–Ω–µ—Å—á–∞—Å—Ç–µ–Ω',
        '–∑–ª–æ–π', '–¥–æ–±—Ä—ã–π', '–≤–µ—Å—ë–ª—ã–π', '–≥—Ä—É—Å—Ç–Ω—ã–π', '–∫—Ä–∞—Å–∏–≤—ã–π', '—É–º–Ω—ã–π',
        '–≥–ª—É–ø—ã–π', '—Å–∏–ª—å–Ω—ã–π', '—Å–ª–∞–±—ã–π', '–±–æ–ª—å–Ω–æ–π', '–∑–¥–æ—Ä–æ–≤—ã–π',
        '–º–æ–ª–æ–¥–æ–π', '—Å—Ç–∞—Ä—ã–π', '–≤—ã—Å–æ–∫–∏–π', '–Ω–∏–∑–∫–∏–π', '—Ç–æ–ª—Å—Ç—ã–π', '—Ö—É–¥–æ–π',
        '–∂–µ–Ω–∞—Ç—ã–π', '—Ä–∞–∑–≤–µ–¥—ë–Ω–Ω—ã–π', '—Ö–æ–ª–æ—Å—Ç–æ–π', '–æ–¥–∏–Ω–æ–∫–∏–π',
        '–≥–æ–ª–æ–¥–Ω—ã–π', '—Å—ã—Ç—ã–π', '–ø—å—è–Ω—ã–π', '—Ç—Ä–µ–∑–≤—ã–π', '—É—Å—Ç–∞–≤—à–∏–π',
        '–∑–∞–Ω—è—Ç—ã–π', '—Å–≤–æ–±–æ–¥–Ω—ã–π', '–±–æ–≥–∞—Ç—ã–π', '–±–µ–¥–Ω—ã–π',
    ]
    
    # –ú—É–∂—Å–∫–∏–µ —Ñ—Ä–∞–∑—ã-–∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã
    MALE_PHRASES = [
        '—è –ø–∞—Ä–µ–Ω—å', '—è –º—É–∂–∏–∫', '—è –º—É–∂', '—è –æ—Ç–µ—Ü', '—è –ø–∞–ø–∞', '—è –¥–µ–¥',
        '—è –º–∞–ª—å—á–∏–∫', '—è –¥—è–¥—è', '—è –±—Ä–∞—Ç', '—è —Å—ã–Ω', '—è –¥—Ä—É–≥',
        '–∫–∞–∫ –º—É–∂–∏–∫', '–∫–∞–∫ –ø–∞—Ü–∞–Ω', '–∫–∞–∫ –±–∞—Ç—è', '–∫–∞–∫ –æ—Ç–µ—Ü',
        '–º–æ—è –∂–µ–Ω–∞', '–º–æ—è –¥–µ–≤—É—à–∫–∞', '–º–æ—è –∂–µ–Ω—â–∏–Ω–∞', '–º–æ—è –±—ã–≤—à–∞—è',
        '—É –º–µ–Ω—è –±–æ—Ä–æ–¥–∞', '–ø–æ–±—Ä–∏–ª—Å—è', '–±—Ä–µ—é—Å—å',
        '—Å–ª—É–∂–∏–ª –≤ –∞—Ä–º–∏–∏', '–∞—Ä–º–∏—è', '–≤–æ–µ–Ω–∫–æ–º–∞—Ç',
        '–∫–∞—á–∞–ª–∫–∞', '—à—Ç–∞–Ω–≥–∞', '–≥–∞–Ω—Ç–µ–ª–∏', '–±–∏—Ü–µ–ø—Å',
    ]
    
    # –ï—Å–ª–∏ –µ—Å—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è ‚Äî –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –∏—Ö
    if messages:
        text = " ".join(messages).lower()
        
        female_score = 0
        male_score = 0
        
        # –°—á–∏—Ç–∞–µ–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è
        for marker in FEMALE_VERB_MARKERS:
            if marker in text:
                female_score += 2  # –ì–ª–∞–≥–æ–ª—ã –≤–µ—Å—è—Ç –±–æ–ª—å—à–µ
        for marker in FEMALE_ADJ_MARKERS:
            if marker in text:
                female_score += 1
        for phrase in FEMALE_PHRASES:
            if phrase in text:
                female_score += 5  # –§—Ä–∞–∑—ã-–∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã –≤–µ—Å—è—Ç –º–Ω–æ–≥–æ
        
        for marker in MALE_VERB_MARKERS:
            if marker in text:
                male_score += 2
        for marker in MALE_ADJ_MARKERS:
            if marker in text:
                male_score += 1
        for phrase in MALE_PHRASES:
            if phrase in text:
                male_score += 5
        
        # –ï—Å–ª–∏ –µ—Å—Ç—å —è–≤–Ω—ã–π –ø–µ—Ä–µ–≤–µ—Å ‚Äî –≤–æ–∑–≤—Ä–∞—â–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
        if female_score > male_score * 1.2:  # 20% –ø–µ—Ä–µ–≤–µ—Å –Ω—É–∂–µ–Ω
            return "–∂–µ–Ω—Å–∫–∏–π"
        elif male_score > female_score * 1.2:
            return "–º—É–∂—Å–∫–æ–π"
        # –ò–Ω–∞—á–µ –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º –ø—Ä–æ–≤–µ—Ä—è—Ç—å –ø–æ –∏–º–µ–Ω–∏
    
    # Fallback ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ –∏–º–µ–Ω–∏ (–¥–ª—è –ø—Å–µ–≤–¥–æ–Ω–∏–º–æ–≤ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç)
    female_endings = ['–∞', '—è', '–∏—è', '—å—è']
    male_names = ['–Ω–∏–∫–∏—Ç–∞', '–∏–ª—å—è', '–∫—É–∑—å–º–∞', '—Ñ–æ–º–∞', '–ª—É–∫–∞', '—Å–∞—à–∞', '–∂–µ–Ω—è', '–≤–∞–ª—è', '–≤–æ–≤–∞', '–º–∏—à–∞', '–≥–æ—à–∞', '–ø–∞—à–∞', '–ª—ë—à–∞', '–≥—Ä–∏—à–∞', '–∫–æ–ª—è', '—Ç–æ–ª—è', '–≤–∞—Å—è', '–ø–µ—Ç—è', '–≤–∞–Ω—è', '–¥–∏–º–∞', '—Å—Ç—ë–ø–∞', '–ª—ë–Ω—è', '–≥–µ–Ω–∞', '–±–æ—Ä—è', '—Ñ–µ–¥—è', '—Å–µ–Ω—è', '–∫–æ—Å—Ç—è', '–≤–∏—Ç—è']
    female_names = ['–∫–∞—Ç—è', '–º–∞—à–∞', '–¥–∞—à–∞', '—Å–∞—à–∞', '–∂–µ–Ω—è', '–≤–∞–ª—è', '–Ω–∞—Å—Ç—è', '–Ω–∞—Ç–∞—à–∞', '—Å–≤–µ—Ç–∞', '–ª–µ–Ω–∞', '–æ–ª—è', '—Ç–∞–Ω—è', '—é–ª—è', '–∞–Ω—è', '–≤–∏–∫–∞', '–∫—Ä–∏—Å—Ç–∏–Ω–∞', '–ª–∏–∑–∞', '–∞–ª–∏–Ω–∞', '–ø–æ–ª–∏–Ω–∞', '–∫—Å–µ–Ω–∏—è', '—Å–æ—Ñ–∏—è', '–º–∞—Ä–∏—è', '–∞–Ω–Ω–∞', '–µ–∫–∞—Ç–µ—Ä–∏–Ω–∞', '–∏—Ä–∏–Ω–∞', '–æ–ª—å–≥–∞', '—Ç–∞—Ç—å—è–Ω–∞', '–Ω–∞—Ç–∞–ª—å—è', '—Å–≤–µ—Ç–ª–∞–Ω–∞', '–µ–ª–µ–Ω–∞', '–∞–ª–µ–∫—Å–∞–Ω–¥—Ä–∞', '–≤–∏–∫—Ç–æ—Ä–∏—è', '–∞–ª—ë–Ω–∞', '–º–∞—Ä–∏–Ω–∞', '–Ω–∞–¥—è', '–Ω–∞–¥–µ–∂–¥–∞', '–≤–µ—Ä–∞', '–ª—é–±–æ–≤—å', '–ª—é–±–∞', '–≥–∞–ª—è', '–≥–∞–ª–∏–Ω–∞', '–Ω–∏–Ω–∞', '–∑–æ—è', '–ª–∞—Ä–∏—Å–∞', '–ª—é–¥–∞', '–ª—é–¥–º–∏–ª–∞', '—Ä–∏—Ç–∞', '—Ç–æ–Ω—è', '–∂–µ–Ω—è', '–≤–∞–ª—è', '—à—É—Ä–∞', '—Ä–∞—è', '–∏—Ä–∞', '–∏–Ω–Ω–∞', '—è–Ω–∞', '–¥–∏–∞–Ω–∞', '–∫–∞—Ä–∏–Ω–∞', '–∞—Ä–∏–Ω–∞', '–¥–∞—Ä–∏–Ω–∞', '–º–∏–ª–∞–Ω–∞', '–µ–≤–∞', '–∞–ª–∏—Å–∞', '—Å–æ–Ω—è']
    name_lower = name.lower().strip()
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏–º–µ–Ω–∞
    if name_lower in female_names:
        return "–∂–µ–Ω—Å–∫–∏–π"
    if name_lower in male_names:
        return "–º—É–∂—Å–∫–æ–π"
    
    # –ü–æ –æ–∫–æ–Ω—á–∞–Ω–∏—é (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø–æ—Ö–æ–∂–µ –Ω–∞ —Ä—É—Å—Å–∫–æ–µ –∏–º—è)
    if any(c in name_lower for c in '–∞–±–≤–≥–¥–µ—ë–∂–∑–∏–π–∫–ª–º–Ω–æ–ø—Ä—Å—Ç—É—Ñ—Ö—Ü—á—à—â—ä—ã—å—ç—é—è'):
        for ending in female_endings:
            if name_lower.endswith(ending) and name_lower not in male_names:
                return "–∂–µ–Ω—Å–∫–∏–π"
    
    return "–º—É–∂—Å–∫–æ–π"  # –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é


class handler(BaseHTTPRequestHandler):
    
    def do_POST(self):
        try:
            content_length = int(self.headers.get('Content-Length', 0))
            body = self.rfile.read(content_length).decode('utf-8')
            data = json.loads(body) if body else {}
            
            victim_name = data.get("victim_name", "–ö—Ç–æ-—Ç–æ")
            victim_username = data.get("victim_username", "")
            victim_messages = data.get("victim_messages", [])
            initial_gender = data.get("initial_gender", "")  # –ü–æ–ª –æ—Ç –±–æ—Ç–∞
            
            # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–æ–ª –ø–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É —Å–æ–æ–±—â–µ–Ω–∏–π
            # –ï—Å–ª–∏ –µ—Å—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è ‚Äî –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –∏—Ö, –∏–Ω–∞—á–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º initial_gender
            if victim_messages:
                gender = detect_gender_from_messages(victim_messages, victim_name)
            elif initial_gender:
                gender = initial_gender
            else:
                gender = detect_gender_from_messages([], victim_name)  # –ü–æ –∏–º–µ–Ω–∏
            
            # –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –ø—Ä–æ–º–ø—Ç–∞
            if victim_messages:
                messages_text = "\n".join([f"- {msg[:100]}" for msg in victim_messages[:5]])
            else:
                messages_text = "- (—Å–æ–æ–±—â–µ–Ω–∏–π –Ω–µ—Ç, –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–æ –∏–º–µ–Ω–∏)"
            
            # –†–∞–Ω–¥–æ–º–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è –¥–ª—è —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è
            category = random.choice(EVENT_CATEGORIES)
            
            # –ê–∫—Ç—É–∞–ª—å–Ω–∞—è —Ç–µ–º–∞ –¥–ª—è —Å–∞—Ç–∏—Ä—ã
            current_topic = random.choice(CURRENT_TOPICS)
            
            # –¢–µ–∫—É—â–∞—è –¥–∞—Ç–∞
            current_date = get_current_date_ru()
            
            # –ü—ã—Ç–∞–µ–º—Å—è –ø–æ–ª—É—á–∏—Ç—å –Ω–æ–≤–æ—Å—Ç–∏
            news_context = fetch_news_headlines()
            
            prompt = SYSTEM_PROMPT.format(
                victim_name=victim_name,
                gender=gender,
                victim_messages=messages_text,
                category=category,
                current_date=current_date,
                current_topic=current_topic,
                news_context=news_context
            )
            
            api_key = os.environ.get("VERCEL_AI_GATEWAY_KEY", "").strip()
            if not api_key:
                self._send_error(500, "API key not configured")
                return
            
            request_body = json.dumps({
                "model": "anthropic/claude-sonnet-4-20250514",
                "max_tokens": 500,
                "temperature": 1.0,  # –ú–∞–∫—Å–∏–º—É–º –∫—Ä–µ–∞—Ç–∏–≤–∞
                "system": prompt,
                "messages": [
                    {
                        "role": "user",
                        "content": f"""–û–¢–ö–†–û–ô –§–û–†–¢–û–ß–ö–£ –ò –£–ù–ò–ó–¨ –≠–¢–û–ì–û –ß–ï–õ–ê!

–ñ–µ—Ä—Ç–≤–∞: {victim_name} ({gender} –ø–æ–ª)
–¢–µ–º–∞: {category.split(':')[0]}
–ê–∫—Ç—É–∞–ª–æ—á–∫–∞: {current_topic}

–ó–ê–î–ê–ß–ê:
1. –û—Ç–∫—Ä–æ–π —Ñ–æ—Ä—Ç–æ—á–∫—É, –ø—É—Å—Ç—å —á—Ç–æ-—Ç–æ –∑–∞–ª–µ—Ç–∏—Ç/—É–ª–µ—Ç–∏—Ç
2. –ñ–Å–°–¢–ö–û –ü–û–°–¢–ï–ë–ò–°–¨ –Ω–∞–¥ {victim_name}
3. –ò—Å–ø–æ–ª—å–∑—É–π —Å–ª–µ–Ω–≥: —á–µ–ª, –∫—Ä–∏–Ω–∂, —Ä–æ—Ñ–ª, –ª–æ—Ö, –¥–Ω–∏—â–µ, –Ω–∏—â–µ–±—Ä–æ–¥, –æ–≤–æ—â
4. –£–Ω–∏–∂–∞–π: —Ç—É–ø–æ—Å—Ç—å, –±–µ–¥–Ω–æ—Å—Ç—å, –≤–Ω–µ—à–Ω–æ—Å—Ç—å, –æ–¥–∏–Ω–æ—á–µ—Å—Ç–≤–æ, –Ω–µ—É–¥–∞—á–∏
5. –°–∫–ª–æ–Ω—è–π –∏–º—è: {{VICTIM_NOM}}, {{VICTIM_ACC}}, {{VICTIM_GEN}} –∏ —Ç.–¥.
6. –ü–æ–ª: {gender} ‚Äî —Å–æ–≥–ª–∞—Å—É–π –≥–ª–∞–≥–æ–ª—ã

–°–¢–ï–ë–ò–°–¨ –ü–û-–ó–õ–û–ú–£! –ö–û–†–û–¢–ö–û –ò –ñ–Å–°–¢–ö–û!"""
                    }
                ]
            }).encode('utf-8')
            
            req = urllib.request.Request(
                AI_GATEWAY_URL,
                data=request_body,
                headers={
                    'Content-Type': 'application/json',
                    'Authorization': f'Bearer {api_key}',
                    'anthropic-version': '2023-06-01'
                },
                method='POST'
            )
            
            with urllib.request.urlopen(req, timeout=30) as response:
                result = json.loads(response.read().decode('utf-8'))
            
            text = result.get("content", [{}])[0].get("text", "–§–æ—Ä—Ç–æ—á–∫–∞ –Ω–µ –æ—Ç–∫—Ä—ã–ª–∞—Å—å. –ó–∞–∫–ª–∏–Ω–∏–ª–æ, –±–ª—è—Ç—å.")
            
            self._send_json(200, {
                "text": text,
                "category": category.split(":")[0],
                "gender": gender,
                "victim_name": victim_name
            })
            
        except urllib.error.HTTPError as e:
            error_body = e.read().decode('utf-8') if e.fp else str(e)
            self._send_error(500, f"AI error: {e.code} - {error_body}")
            
        except Exception as e:
            self._send_error(500, str(e))
    
    def do_GET(self):
        self._send_json(200, {"status": "ok", "service": "ventilate-chat"})
    
    def do_OPTIONS(self):
        self.send_response(200)
        self.send_header('Access-Control-Allow-Origin', '*')
        self.send_header('Access-Control-Allow-Methods', 'GET, POST, OPTIONS')
        self.send_header('Access-Control-Allow-Headers', 'Content-Type')
        self.end_headers()
    
    def _send_json(self, status: int, data: dict):
        self.send_response(status)
        self.send_header('Content-Type', 'application/json')
        self.send_header('Access-Control-Allow-Origin', '*')
        self.end_headers()
        self.wfile.write(json.dumps(data, ensure_ascii=False).encode('utf-8'))
    
    def _send_error(self, status: int, message: str):
        self._send_json(status, {"error": message})
